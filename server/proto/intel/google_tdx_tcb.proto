edition = "2023";

package third_party_confidential_space_server_proto_intel;

import "google/protobuf/timestamp.proto";
import "third_party/confidential_space/server/proto/common/shared.proto";

option go_package = "github.com/GoogleCloudPlatform/confidential-space/proto/gen/google_tdx_tcb";

message TDXTCBInfo {
  // Serialized TCB info proto.
  bytes gcp_tcb_info = 1;

  // Signature of gcp_tcb_info
  bytes signature = 2;

  // Signature algorithm used to generate the signature.
  common.SignatureAlgorithm signature_algorithm = 3;
}

// IntelRim proto wrapper to allow for schema changes
message IntelRim {
  // Serialized TdxTcb JSON. Raw response from the Intel PCS service.
  bytes tdx_tcb = 1;

  // Time the RIM was published.
  google.protobuf.Timestamp timestamp = 2;

  // Time after which the RIM should no longer be used.
  google.protobuf.Timestamp exp = 3;

  // DER format certificate of the key that signed this document.
  bytes cert = 4;

  reserved 5;  // Reserve 5, make ca_bundle item 6 to match endorsement proto

  // PEM certificates of keys in least intermediateâ€¦root order.
  bytes ca_bundle = 6;
}
